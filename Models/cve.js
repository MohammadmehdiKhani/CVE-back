const Joi = require("joi");
const mongoose = require("mongoose");
/*
const { Program } = require("./program");

const express = require("express");
var ObjectId = mongoose.Types.ObjectId;

const app = express();

app.use(express.json());

mongoose
  .connect("mongodb://127.0.0.1:27017/CVE")
  .then(() => console.log("connected to DB"))
  .catch((err) => console.log("can not connect to DB"));

app.listen(3001, () => console.log("listening on port 3001"));
*/
const cveSchema = new mongoose.Schema({
  cveCode: {
    type: String,
    required: true,
    minlength: 3,
    maxlength: 50,
    unique: true,
  },

  text: { type: String, required: true, minlength: 3, maxlength: 2000 },
  lastModified: { type: Date },
  type: { type: String },
  exploitabilityScore: { type: Number },
  impactScore: { type: Number },
  source: { type: String },
  format: { type: String },
  baseScore: { type: String },
});

const CVE = mongoose.model("CVE", cveSchema);

/*
addPro = async () => {
  const cve = new CVE({
    cveCode: "cve-2023-3",
    text: "this is easy to solve",
  });
  await cve.save();
};

addPro();
*/
exports.CVE = CVE;
