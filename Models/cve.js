const Joi = require("joi");
const mongoose = require("mongoose");

const cveSchema = new mongoose.Schema({
  cveCode: {
    type: String,
    required: true,
    minlength: 3,
    maxlength: 50,
    unique: true,
  },

  text: { type: String, required: true, minlength: 3, maxlength: 2000 },
  lastModified: { type: Date },
  type: { type: String },
  exploitabilityScore: { type: Number },
  impactScore: { type: Number },
  source: { type: String },
  format: { type: String },
  baseScore: { type: String },
});

const CVE = mongoose.model("CVE", cveSchema);

exports.CVE = CVE;
