const Joi = require("joi");
const mongoose = require("mongoose");
const { CVE } = require("./cve");
const { User } = require("./user");

const express = require("express");

const app = express();

app.use(express.json());

const programSchema = new mongoose.Schema({
  cpeName: {
    type: String,
    required: true,
    unique: true,
  },
  cpeId: String,
  title: String,

  users: [{ type: mongoose.Schema.Types.ObjectId, ref: "User" }],

  cves: [{ type: mongoose.Schema.Types.ObjectId, ref: "CVE" }],
  newCVEs: [{ type: mongoose.Schema.Types.ObjectId, ref: "CVE" }],
});

const CPE = mongoose.model("CPE", programSchema);

/*validateProgram = (user) => {
  const schema = Joi.object({
    username: Joi.string().min(3).max(50).required(),
    password: Joi.string().min(3).max(300).required(),
    email: Joi.string().min(3).max(300).required().email(),
    programs: Joi.array(),
  });

  const validation = schema.validate(user);
  return validation;
}; */

exports.CPE = CPE;
//exports.validate = validateProgram;
